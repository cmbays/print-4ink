<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="GitHub Actions CI workflow, Vitest schema tests, and mock data UUID fix. Catches build/lint/type/test failures on every push and PR."><title>CI &amp; Testing Setup &mdash; Screen Print Pro KB</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/decisions.DGAibQh0.css"></head> <body>  <main class="max-w-[720px] mx-auto px-6 py-12"> <!-- Back link --> <a href="/" class="inline-flex items-center gap-1.5 text-text-muted text-sm hover:text-action transition-colors mb-8"> <span>&larr;</span> Back to Index
</a> <!-- Tag pills --> <div class="flex items-center gap-2 mb-4"> <span class="text-[11px] font-semibold uppercase tracking-wide px-2 py-0.5 rounded bg-success/12 text-success"> feature </span><span class="text-[11px] font-semibold uppercase tracking-wide px-2 py-0.5 rounded bg-success/12 text-success"> build </span><span class="text-[11px] font-semibold uppercase tracking-wide px-2 py-0.5 rounded bg-warning/12 text-warning"> learning </span> </div> <!-- Title --> <h1 class="text-[28px] font-bold tracking-tight leading-tight mb-2">CI &amp; Testing Setup</h1> <!-- Subtitle --> <p class="text-[15px] text-text-secondary leading-relaxed mb-6">GitHub Actions CI workflow, Vitest schema tests, and mock data UUID fix. Catches build/lint/type/test failures on every push and PR.</p> <!-- Meta grid --> <div class="border border-border rounded-lg overflow-hidden mb-6"> <div class="grid grid-cols-2"> <!-- Row 1 --> <div class="px-4 py-3 border-b border-border"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Date</div> <div class="text-sm text-text-primary">2026-02-07</div> </div> <div class="px-4 py-3 border-b border-border border-l border-border"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Branch</div> <div class="text-sm"> <code class="font-mono text-xs bg-bg-surface px-1.5 py-0.5 rounded text-action">infra/ci-testing-setup</code> </div> </div> <!-- Row 2 --> <div class="px-4 py-3 border-b border-border"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Phase</div> <div class="text-sm text-text-primary">Phase 1</div> </div> <div class="px-4 py-3 border-b border-border border-l border-border"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Vertical</div> <div class="text-sm text-text-primary"> <a href="/verticals/meta" class="text-action hover:underline">Meta</a>  </div> </div> <!-- Row 3 --> <div class="px-4 py-3"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Stage</div> <div class="text-sm"> <a href="/verticals/meta/build" class="inline-flex items-center bg-bg-surface text-action text-xs font-medium px-2 py-0.5 rounded hover:bg-action/10 transition-colors"> Build </a> </div> </div> <div class="px-4 py-3 border-l border-border"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-1">Status</div> <div class="text-sm font-medium text-success"> Complete </div> </div> </div> </div> <!-- Workflow chain --> <div class="mb-6"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-2">Workflow Chain</div> <div class="bg-bg-elevated border border-border rounded-lg px-4 py-2"> <div class="overflow-x-auto"><div class="flex items-center gap-1.5 min-w-max py-2"><a href="/sessions/2026-02-07-shaping-skills" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Shaping Skills Evaluation"><span class="font-semibold">Research</span><span class="opacity-60">&middot;</span><span class="opacity-80">Shaping Skills Evaluati…</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-08-strategic-pivot" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Strategic Pivot: Vertical-by-Vertical"><span class="font-semibold">Impl Plan</span><span class="opacity-60">&middot;</span><span class="opacity-80">Strategic Pivot: Vertic…</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-07-ci-testing" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-action/10 border-action/30 text-action font-medium" title="CI &#38; Testing Setup"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">CI &amp; Testing Setup</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-07-skills-implementation" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Skills Implementation"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">Skills Implementation</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-08-agent-architecture" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Agent Architecture"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">Agent Architecture</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-08-vercel-setup" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Vercel Setup with Access Code Protection"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">Vercel Setup with Acces…</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-08-breadboarding-skill" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Breadboarding Skill"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">Breadboarding Skill</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-10-work-orchestrator" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="work() — Worktree Orchestrator"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">work() — Worktree Orche…</span></a><span class="text-text-muted text-[11px] select-none">&rarr;</span><a href="/sessions/2026-02-10-worktree-migration" class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-[12px] border transition-colors whitespace-nowrap bg-bg-surface border-border text-text-secondary hover:text-text-primary hover:border-action/20" title="Git Worktree Migration + Memory Refactoring"><span class="font-semibold">Build</span><span class="opacity-60">&middot;</span><span class="opacity-80">Git Worktree Migration …</span></a></div></div> </div> </div> <!-- Session resume --> <div class="bg-bg-elevated border border-border rounded-lg px-4 py-3 mb-6"> <div class="text-[11px] font-semibold uppercase tracking-wide text-text-muted mb-2">Resume Session</div> <code class="font-mono text-xs text-action select-all">claude --resume 29d21a39-94a9-4cb3-8ac1-bcc442a85d68</code> </div> <!-- PR link -->  <!-- Divider --> <hr class="border-t border-border mb-8"> <!-- Body content --> <div class="prose"> <h2 id="what-was-built">What Was Built</h2>
<h3 id="github-actions-ci">GitHub Actions CI</h3>
<p>Runs on every push/PR to <code>main</code>. Four sequential checks:</p>






























<table><thead><tr><th>Step</th><th>Command</th><th>Catches</th></tr></thead><tbody><tr><td>Type check</td><td><code>tsc --noEmit</code></td><td>TypeScript errors</td></tr><tr><td>Lint</td><td><code>eslint</code></td><td>Code quality issues</td></tr><tr><td>Test</td><td><code>vitest run</code></td><td>Schema validation failures</td></tr><tr><td>Build</td><td><code>next build</code></td><td>Broken imports, bad JSX</td></tr></tbody></table>
<p>File: <code>.github/workflows/ci.yml</code></p>
<h3 id="vitest-schema-tests">Vitest Schema Tests</h3>
<p>66 tests across 6 test files:</p>








































<table><thead><tr><th>File</th><th>Tests</th><th>Validates</th></tr></thead><tbody><tr><td>garment.test.ts</td><td>8</td><td>Valid garment, empty strings, negative/fractional sizes</td></tr><tr><td>customer.test.ts</td><td>6</td><td>Valid customer, invalid UUID, invalid email</td></tr><tr><td>job.test.ts</td><td>21</td><td>All 6 production states, 4 priorities, print locations</td></tr><tr><td>quote.test.ts</td><td>14</td><td>All 4 statuses, line items, negative prices, datetime</td></tr><tr><td>screen.test.ts</td><td>10</td><td>All 3 burn statuses, mesh count, UUID validation</td></tr><tr><td>mock-data.test.ts</td><td>7</td><td>All mock data parses, referential integrity (FK links)</td></tr></tbody></table>
<p>Tests live in <code>lib/schemas/__tests__/</code></p>
<hr>
<h2 id="bug-discovered--fixed">Bug Discovered &#x26; Fixed</h2>
<p><strong>Bug: Mock Data UUIDs Invalid</strong></p>
<p>The schema tests immediately caught that <strong>8 mock data UUIDs</strong> were not RFC-4122 compliant. Zod v4 validates the full UUID format strictly:</p>
<ul>
<li><strong>Version byte</strong> (3rd group): must start with <code>1-8</code></li>
<li><strong>Variant byte</strong> (4th group): must start with <code>8</code>, <code>9</code>, <code>a</code>, or <code>b</code></li>
</ul>
<p>Hand-crafted UUIDs like <code>q1a2b3c4-...</code> and <code>s1a2b3c4-...</code> used non-hex characters (<code>q</code>, <code>s</code>) and invalid variant bytes (<code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>). All 8 were fixed in <code>lib/mock-data.ts</code>.</p>
<p>This validates the decision to test schemas early — these would have broken Phase 3 backend validation silently.</p>
<hr>
<h2 id="docs-updated">Docs Updated</h2>
<ul>
<li><code>CLAUDE.md</code> — Added <code>npm test</code> and <code>npm run test:watch</code> to Commands, Zod UUID lesson to Lessons Learned</li>
<li><code>docs/TECH_STACK.md</code> — Added Testing section with Vitest entry</li>
<li><code>progress.txt</code> — Added CI + Testing infrastructure and session log</li>
</ul>
<hr>
<h2 id="decision-rationale">Decision Rationale</h2>
<p>Phase 1 is a UI mockup — testing strategy is intentionally minimal and targeted:</p>
<ul>
<li><strong>Schema tests now</strong>: High ROI — schemas carry forward to Phase 3 backend. 66 tests cost minutes to write.</li>
<li><strong>E2E deferred</strong>: UI changes heavily at each checkpoint. Writing Playwright tests now means rewriting after every review.</li>
<li><strong>Component tests skipped</strong>: The components ARE the deliverable and they’re changing rapidly. Negative ROI.</li>
<li><strong>No Claude Code hooks</strong>: CI catches the same issues asynchronously. Hooks add friction during rapid prototyping.</li>
</ul> </div> <!-- Footer --> <footer class="mt-16 pt-6 border-t border-border"> <p class="text-xs text-text-muted text-center">
Screen Print Pro &mdash; CI &amp; Testing Setup &mdash; 2026-02-07 </p> </footer> </main>  </body></html>