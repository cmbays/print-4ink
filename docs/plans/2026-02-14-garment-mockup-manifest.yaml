# Execution Manifest — Garment Mockup Engine
# Generated retroactively from docs/plans/2026-02-14-garment-mockup-impl-plan.md
# Status: REFERENCE ONLY (mockup engine already merged as PR #141)
#
# This manifest documents what the execution would have looked like
# if `work build` had been used. Serves as a template for future builds.
#
# Validate: yq '.' docs/plans/2026-02-14-garment-mockup-manifest.yaml

vertical: garments
plan: docs/plans/2026-02-14-garment-mockup-impl-plan.md
design: docs/plans/2026-02-14-garment-mockup-design.md
breadboard: docs/breadboards/mockup-engine-breadboard.md

waves:
  - name: "Foundation (Tasks 1-4)"
    serial: false  # Tasks 1-4 can run in parallel
    sessions:
      - topic: mockup-w0-schemas
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for full task details.
          Read docs/breadboards/mockup-engine-breadboard.md for the affordance map.
          Read CLAUDE.md for coding standards (Zod-first types, Tailwind tokens).

          Build Task 1: Mockup Template + Print Zone Schemas
          - Create lib/schemas/mockup-template.ts (MockupView, PrintZone, MockupTemplate)
          - Write tests in lib/schemas/__tests__/mockup-template.test.ts
          - TDD: write failing tests first, then implement

          Commit and push when tests pass.
        stage: build

      - topic: mockup-w0-constants
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 2 details.
          Read CLAUDE.md for coding standards.

          Build Task 2: Print Zone Constants
          - Create lib/constants/print-zones.ts (PRINT_ZONES, PRINT_POSITION_LABELS, PRINT_POSITION_ALIASES, normalizePosition)
          - Write tests in lib/schemas/__tests__/print-zones.test.ts
          - TDD: write failing tests first, then implement

          Commit and push when tests pass.
        stage: build

      - topic: mockup-w0-color-util
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 3 details.

          Build Task 3: Color Matrix Utility
          - Create lib/helpers/color-matrix.ts (hexToRgb, hexToColorMatrix)
          - Write tests in lib/helpers/__tests__/color-matrix.test.ts
          - TDD: write failing tests first, then implement
          - Uses Rec. 709 luminance weights for greyscale → color mapping

          Commit and push when tests pass.
        stage: build

      - topic: mockup-w0-svg-templates
        prompt: |
          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 4 details.

          Build Task 4: SVG Garment Templates
          - Create public/mockup-templates/t-shirts-front.svg (greyscale silhouette, 400x480 viewBox)
          - Create public/mockup-templates/t-shirts-back.svg
          - Greyscale fills with shading (lighter center, darker edges)
          - No text, no decoration — just garment shape

          Verify SVGs render correctly in browser.
          Commit and push.
        stage: build

  - name: "Data Layer (Tasks 5, 5A)"
    serial: true  # 5A depends on 5
    sessions:
      - topic: mockup-w1-mock-data
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Tasks 5 and 5A.

          Build Task 5: Mock Mockup Template Data
          - Add MockupTemplate mock data to lib/mock-data.ts
          - Connect to existing garment catalog entries
          - Verify mock data validates against schema

          Then Task 5A: Extend JobCard View Model
          - Add optional garmentCategory, garmentColorHex, primaryArtworkUrl to board-card.ts
          - Update mock data card projections
          - Verify existing board-card tests still pass

          Commit each task separately.
        stage: build
        dependsOn: mockup-w0-schemas

  - name: "Components (Tasks 6-10)"
    serial: false  # Tasks 6-9 parallel, Task 10 depends on all
    sessions:
      - topic: mockup-w2-filter-provider
        prompt: |
          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 6.

          Build Task 6: MockupFilterProvider Component
          - Create components/features/mockup/MockupFilterProvider.tsx
          - Renders shared SVG <defs> with feColorMatrix filters
          - Deduplicates colors, generates filter IDs as garment-tint-{hex}

          Commit and push.
        stage: build
        dependsOn: mockup-w0-color-util

      - topic: mockup-w2-core-component
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Tasks 7, 8, 9, 10.

          Build in sequence:
          - Task 7: Core GarmentMockup component (SVG composition engine)
          - Task 8: GarmentMockupThumbnail (memo'd xs wrapper)
          - Task 9: GarmentMockupCard (interactive with view toggle)
          - Task 10: Barrel export (components/features/mockup/index.ts)

          Verify with npx tsc --noEmit after each task.
          Commit each task separately.
        stage: build
        dependsOn: mockup-w1-mock-data

  - name: "Integration (Tasks 11-13)"
    serial: false  # All three integration tasks can run in parallel
    sessions:
      - topic: mockup-w3-quote-integration
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 11.

          Build Task 11: Integration — QuoteDetailView
          - Replace ArtworkPreview with GarmentMockupThumbnail
          - Add MockupFilterProvider per-page (not global)
          - Use normalizePosition() for location string conversion
          - Breadboard Gap #1 and #4 addressed here

          Verify on dev server. Commit and push.
        stage: build
        dependsOn: mockup-w2-core-component

      - topic: mockup-w3-kanban-integration
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 12.

          Build Task 12: Integration — Kanban Board Cards
          - Add GarmentMockupThumbnail to JobBoardCard
          - Add MockupFilterProvider to board/page.tsx
          - Uses enriched JobCard view model from Task 5A
          - Graceful degradation for cards without garment data

          Verify on dev server at /jobs/board. Commit and push.
        stage: build
        dependsOn: mockup-w2-core-component

      - topic: mockup-w3-job-integration
        prompt: |
          Use the build-session-protocol skill to guide your workflow.

          Read docs/plans/2026-02-14-garment-mockup-impl-plan.md for Task 13.

          Build Task 13: Integration — Job Detail Page
          - Add GarmentMockupCard to job detail page ("What We're Printing" section)
          - Resolve garment category + color from job data
          - Map artworkIds[] to printLocations[] (1:1 order, Breadboard Gap #2)
          - Use normalizePosition() (Breadboard Gap #1)
          - Add per-page MockupFilterProvider (Breadboard Gap #4)

          Verify on dev server. Commit and push.
        stage: build
        dependsOn: mockup-w2-core-component

  - name: "Validation + PR (Tasks 14-15)"
    serial: true
    sessions:
      - topic: mockup-w4-validate
        prompt: |
          Run full validation:
          1. npx tsc --noEmit (no type errors)
          2. npm test (all tests pass)
          3. npm run lint (no lint errors)
          4. npm run build (production build succeeds)

          Fix any issues found. Commit fixes.
          Then create PR with gh pr create.
        stage: build
        dependsOn: mockup-w3-quote-integration
